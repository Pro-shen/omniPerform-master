<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.omniperform.system.mapper.OptimizationEffectDataMapper">

    <resultMap id="OptimizationEffectDataResult" type="com.omniperform.system.domain.OptimizationEffectData">
        <result property="id" column="id" />
        <result property="statDate" column="stat_date" />
        <result property="monthYear" column="month_year" />
        <result property="metricName" column="metric_name" />
        <result property="metricValue" column="metric_value" />
        <result property="momRate" column="mom_rate" />
        <result property="yoyRate" column="yoy_rate" />
        <result property="regionCode" column="region_code" />
        <result property="createTime" column="create_time" />
        <result property="updateTime" column="update_time" />
    </resultMap>

    <select id="selectByUnique" resultMap="OptimizationEffectDataResult">
        select id, stat_date, month_year, metric_name, metric_value, mom_rate, yoy_rate, region_code, create_time, update_time
        from optimization_effect_data
        where stat_date = #{statDate}
          and metric_name = #{metricName}
          <if test="regionCode != null">and region_code = #{regionCode}</if>
          <if test="regionCode == null">and region_code is null</if>
    </select>

    <insert id="insertOptimizationEffectData" parameterType="com.omniperform.system.domain.OptimizationEffectData">
        insert into optimization_effect_data (stat_date, month_year, metric_name, metric_value, mom_rate, yoy_rate, region_code, create_time, update_time)
        values (#{statDate}, #{monthYear}, #{metricName}, #{metricValue}, #{momRate}, #{yoyRate}, #{regionCode}, #{createTime}, #{updateTime})
    </insert>

    <update id="updateOptimizationEffectData" parameterType="com.omniperform.system.domain.OptimizationEffectData">
        update optimization_effect_data
        <trim prefix="set" suffixOverrides=",">
            <if test="statDate != null">stat_date = #{statDate},</if>
            <if test="monthYear != null">month_year = #{monthYear},</if>
            <if test="metricName != null">metric_name = #{metricName},</if>
            <if test="metricValue != null">metric_value = #{metricValue},</if>
            <if test="momRate != null">mom_rate = #{momRate},</if>
            <if test="yoyRate != null">yoy_rate = #{yoyRate},</if>
            <if test="regionCode != null">region_code = #{regionCode},</if>
            <if test="updateTime != null">update_time = #{updateTime},</if>
        </trim>
        where id = #{id}
    </update>

    <select id="selectList" resultMap="OptimizationEffectDataResult">
        select id, stat_date, month_year, metric_name, metric_value, mom_rate, yoy_rate, region_code, create_time, update_time
        from optimization_effect_data
        <where>
            <if test="statDate != null">and stat_date = #{statDate}</if>
            <if test="monthYear != null and monthYear != ''">and month_year = #{monthYear}</if>
            <if test="metricName != null and metricName != ''">and metric_name = #{metricName}</if>
            <if test="regionCode != null and regionCode != ''">and region_code = #{regionCode}</if>
        </where>
        order by stat_date desc, metric_name asc
    </select>

</mapper>